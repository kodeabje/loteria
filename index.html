<!DOCTYPE html>
<html>
<head>
    <title>Loter&iacute;a Mexicana</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #container {
            height: 100%; /* Full height of the parent */
            width: 100%; /* Full width of the parent */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between; /* Adjust spacing */
        }

        #card {
            height: 80%;
            max-width: 95%;
            cursor: pointer;
            object-fit: contain;
            margin: 10px;
        }

        #loteriaButton {
            height: 15%;
            max-width: 95%;
            width: 100%; /* Full width for better visibility */
            padding: 10px 20px;
            font-size: 4vh; /* Adjust font size for mobile */
            cursor: pointer;
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
            margin: 10px;
        }

    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div id="container">
        <img src="cards/0.jpg" alt="Lotería card" id="card">
        <button id="loteriaButton">¡Loteria!</button>
    </div>

<script>
        document.addEventListener('DOMContentLoaded', () => {
            const loteriaCards = [
                "1 el gallo", "2 el diablito", "3 la dama", "4 el catrin", "5 el paraguas",
                "6 la sirena", "7 la escalera", "8 la botella", "9 barril", "10 arbol",
                "11 melon", "12 el valiente", "13 el gorrito", "14 la muerte", "15 la pera",
                "16 la bandera", "17 el bandolon", "18 el violoncello", "19 la garza", "20 el pajaro",
                "21 la mano", "22 la bota", "23 la luna", "24 el cotorro", "25 el borracho",
                "26 el negrito", "27 el corazon", "28 la sandia", "29 el tambor", "30 el camaron",
                "31 las jaras", "32 el musico", "33 la arana", "34 el soldado", "35 la estrella",
                "36 el cazo", "37 el mundo", "38 el apache", "39 el nopal", "40 el alacran",
                "41 la rosa", "42 la calavera", "43 la campana", "44 el cantarito", "45 el venado",
                "46 el sol", "47 la corona", "48 la chalupa", "49 el pino", "50 el pescado",
                "51 la palma", "52 la maceta", "53 el arpa", "54 la rana"
            ];

            let shownCards = new Set();
            const cardElement = document.getElementById('card');
            let gameEnded = false;

            function playSound(randomCard) {
                const audio = new Audio(`audio/${randomCard}.mp3`);
                audio.play().catch(e => console.error("Error playing audio:", e));
            }

            function getRandomCard() {
                if (loteriaCards.length === 0) {
                    return null;
                }
                const randomIndex = Math.floor(Math.random() * loteriaCards.length);
                return loteriaCards.splice(randomIndex, 1)[0];
            }

            function resetGame() {
                loteriaCards.push(...shownCards);
                shownCards.clear();
                gameEnded = false;
                cardElement.src = `cards/0.jpg`;
            }

            function handleCardInteraction() {
                if (gameEnded) {
                    resetGame();
                    return;
                }

                const randomCard = getRandomCard();
                if (randomCard) {
                    shownCards.add(randomCard);
                    cardElement.src = `cards/${randomCard}.jpg`;
                    playSound(randomCard); // Play sound for the card
                } else {
                    cardElement.src = `cards/99.svg`;
                    gameEnded = true;
                    triggerConfetti();
                }
            }

            cardElement.addEventListener('click', handleCardInteraction);

            document.addEventListener('keydown', (event) => {
                if ((event.key === 'Enter' || event.key === ' ') && document.activeElement !== loteriaButton) {
                    handleCardInteraction();
                }
            });

            function triggerConfetti() {
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            }
 
            function playWinSound() {
                const winAudio = new Audio('audio/win.wav');
                winAudio.play().catch(e => console.error('Error playing win sound:', e));
            }

            const loteriaButton = document.getElementById('loteriaButton');
                loteriaButton.addEventListener('click', () => {
                    if (!gameEnded) {
                        triggerConfetti();
                        playWinSound(); // Corrected this line to directly call playWinSound
                        gameEnded = true;
                        setTimeout(resetGame, 3000); // Resets the game after 3 seconds
                    }
            });

        });
    </script>
</body>
</html>
